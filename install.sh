#!/usr/bin/env bash

# TFC - Onion-routed, endpoint secure messaging system
# Copyright (C) 2013-2022  Markus Ottela
#
# This file is part of TFC.
#
# TFC is free software: you can redistribute it and/or modify it under the terms
# of the GNU General Public License as published by the Free Software Foundation,
# either version 3 of the License, or (at your option) any later version.
#
# TFC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
# without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
# PURPOSE. See the GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with TFC. If not, see <https://www.gnu.org/licenses/>.

# Installer configuration

INSTALL_DIR="/opt/tfc"


# ----------------------------------------------------------------------------------------

# PIP dependency file hashes
declare -A dependency_hashes
dependency_hashes['appdirs-1.4.4-py2.py3-none-any.whl']='8e6c1ea544013ea2567cda2d8b8c7b441bc50ac689aa7f95de67e3795aa083e9592c687d74fdbb37f5a75e0beab398fe47df5bced14ee9c204cfe5ecc364ef44'
dependency_hashes['appdirs-1.4.4.tar.gz']='8b0cdd9fd471d45b186aa47607691cf378dabd3edc7b7026a57bd6d6f57698e86f440818a5e23ba4288b35d6bb8cb6eb0106eae8aab09d8863ee15025d300883'
dependency_hashes['argon2_cffi-21.3.0-py3-none-any.whl']='3093f5ae0220dc4c85f741dcd413ba8b19e8b91be7d253c7f2548a1ec9ec99298b2ce7d809be16f497323ffc6733acd35eb201fadd6d91560e41901ed3c09da9'
dependency_hashes['argon2-cffi-21.3.0.tar.gz']='6cb2a075f3bb7040ee7f552d082bfa2f3df0854649d9c84fdfdb42bb4bee2133b8a35a20be2b3c887931efda12fbbb00815d8d88170b7e20b3ca19c86f97057e'
dependency_hashes['argon2_cffi_bindings-21.2.0-cp36-abi3-manylinux_2_17_aarch64.manylinux2014_aarch64.whl']='c3218d723db5c8f2dbc9c737a3ce24d52291a8056b855c6e988956821894b695f2afd50b189a581e9cb5a5d1c13b9b1144be9fb6296a62681b209412caf85b42'
dependency_hashes['argon2_cffi_bindings-21.2.0-cp36-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl']='7a77d7e0becc167b7b348b19d5fc65e25fea4dd93a8e26c203b39f88691515a756a78becfb665a4aa965112a9b561be6c4461fe38db422fe20198b3139d652ff'
dependency_hashes['argon2_cffi_bindings-21.2.0-cp36-abi3-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl']='1bd48d7a11cb99cc0d8526b2dc156e025002092d1f7c60632a0470275ade2374d3be6138ecf924eae2c33fb5d29fef16729b710294cc0b8f35f50a7544d17cc5'
dependency_hashes['argon2_cffi_bindings-21.2.0-cp36-abi3-musllinux_1_1_aarch64.whl']='c1f3ede9138689922619a240242a9d11aaf5942058c896be8ddce517d3ebf386767804e93d9dc4055ad04c682560764e9020c87f96f0d949a36e758025d09fe1'
dependency_hashes['argon2_cffi_bindings-21.2.0-cp36-abi3-musllinux_1_1_i686.whl']='ddb220ba4de3b61cefb657776d64ea0351e89b1f6e2eb04664e024f3e0dc46f1cdb11159b79f8cb9d0530c3dbc4bcfb9d89234fff567d53b06e0564ffa46afea'
dependency_hashes['argon2_cffi_bindings-21.2.0-cp36-abi3-musllinux_1_1_x86_64.whl']='96c611449056eccf03f2e2cb5f8b6353ddd9f852c607f2fc6cda5f13bf8f8d554f2679b6c221b2114ff0b3ae5cb9ba841a7fc1affde840f5dcda65eb9c319d83'
dependency_hashes['argon2_cffi_bindings-21.2.0-pp37-pypy37_pp73-manylinux_2_17_aarch64.manylinux2014_aarch64.whl']='7097f92df079b66b1d59b699523e2a87f2864e1e3c59bc2a4c71cf5657e6f3b094c62e626009602d1c44f07b5e1f2fc79ab03e916475cde07b6b6c6494e7388d'
dependency_hashes['argon2_cffi_bindings-21.2.0-pp37-pypy37_pp73-manylinux_2_17_x86_64.manylinux2014_x86_64.whl']='d8556d123fb96046837c6eb9205cb9fdb817f5ec6aa482f9f6ded77a3e67f1b49a21e1273acc0fcbaed7f4bf46b34fd555ec085ffc9a2daea1345186444f7c7c'
dependency_hashes['argon2_cffi_bindings-21.2.0-pp37-pypy37_pp73-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl']='8940ebaa9466f7810e385d0721042ae9c117480cc659436cd903b5c37af02fd9c9dce8d5ed95fb45ef7305777445cdb8fb00c82671bd577e1eeaf81f2691ae8d'
dependency_hashes['argon2_cffi_bindings-21.2.0-pp38-pypy38_pp73-manylinux_2_17_aarch64.manylinux2014_aarch64.whl']='9c77fbaecb073de920ed570cb7c7956a04c904e7e9616badde275791048a487fcd7e85eb6bf79d3f6bba6fdbc398e32cc208bda8fe368a84897b8d35da8e6bbd'
dependency_hashes['argon2_cffi_bindings-21.2.0-pp38-pypy38_pp73-manylinux_2_17_x86_64.manylinux2014_x86_64.whl']='74f931f3262333e3451295075abbfe0c323beadad36ffe73b65143e906f1e8cab924601a56a3f184ca2516fedcb69dc7d8dc6ea1d0ba25bccb21476a89bc46d8'
dependency_hashes['argon2_cffi_bindings-21.2.0-pp38-pypy38_pp73-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl']='740c76d800bf8bea95f800457ef03d4125b262d034e4a62e66615144a8abe35950b37fe5627553e5bc448ffe32f77ebeee5e2a04857409f53604fb30de7d8d72'
dependency_hashes['argon2-cffi-bindings-21.2.0.tar.gz']='71d023ae96073ed78599e4f4e42f8efcc985cc329adeea00b14b54eaac1e6a545e6ad9b7f4cfdc60a4e9c396f95053c0ccb6f6f67d92f70265f91315fff4a390'
dependency_hashes['backports.entry_points_selectable-1.1.1-py2.py3-none-any.whl']='d3f78a1f0f119cd6d582ace247739554662243609ea608b697e156f4f7a65f8e201fd0372b84553b8e762ac4f7e0141bb40cf117fdd1efc08c299b5a7bc9f0bd'
dependency_hashes['backports.entry_points_selectable-1.1.1.tar.gz']='117f177ef150350c0befe84c6737d7e35044b1559529dd98c5c4b8341d5f68d975cc088a9e0c50025913725172237026385c374dac9941e2e52bf5f4724a461c'
dependency_hashes['certifi-2022.9.14-py3-none-any.whl']='1e73c69399fa3be090f60fd70d897c1bc2a4bb27f05a0082cbda92e78d81a5f9fb78d15af01184713781a59c304e3350db223e55486329b60ace7996be86cf69'
dependency_hashes['certifi-2022.9.14.tar.gz']='99d35b7a834d2b0c7765c943a308855256153f1b7b7b271ac114628b85bbb50b3041c32fd7cec697b00138465ca525b990b1f9ad9e1553b9dc2be88eddcb3f1f'
dependency_hashes['cffi-1.15.1-cp310-cp310-manylinux_2_12_i686.manylinux2010_i686.manylinux_2_17_i686.manylinux2014_i686.whl']='160432f1765330dab76807ec42052cf41cf33922f7b77713aeac0f99af1da8107f1cee85fdc2d13db620a8d21c24423853dd55936204109e429331828e2c576c'
dependency_hashes['cffi-1.15.1-cp310-cp310-manylinux_2_17_aarch64.manylinux2014_aarch64.whl']='2c125d6b2cbfca5b3174095a6fe653fa2c58762aca9a9c46024d50ae104acdf10ddac2014ccad58ba95dbe3c4c8c2589a26292f23a28c1ffafb9aff4d60878dd'
dependency_hashes['cffi-1.15.1-cp310-cp310-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl']='73eb0ea04f5f3c1e9e12a07cdb01b2095f7eb329aaaf9686c40087d8e59944acf4d616b6f774139593de176945ceb510fa86fa546d165bd0a2e8c378c23ad552'
dependency_hashes['cffi-1.15.1-cp310-cp310-manylinux_2_17_s390x.manylinux2014_s390x.whl']='49ef4f829cd9b8e29964b2e0a96a05f8230a510a6ef78b3f5ad10a04e17f4a6356955325be23d2e770518d6439613ebd3e851874a5c3d0e9831018fdd60fde2c'
dependency_hashes['cffi-1.15.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl']='35399df0a0ae1e10699d743e11104f0340a3d99621874cbb33594449653baf99b9ba4d633005165d7e70a2282bc46924e08ce4d7e60d17cd1fa30d0b37da9543'
dependency_hashes['cffi-1.15.1-cp310-cp310-musllinux_1_1_i686.whl']='2f75e683e617abbf709328ea6500d4d688078e378f5447fd923f7ec9d1722a9a38292061b762098177d0e12b221437c8970bb8a96b0423c3b55f5c2471f71634'
dependency_hashes['cffi-1.15.1-cp310-cp310-musllinux_1_1_x86_64.whl']='6cb0451be3df9a5d38b26ce6125d6f924811ccc49e6d7019835d7de9a8524cf8764f852fe688d085610d15b6feedec196d00edad862264b3a06d755f58586483'
dependency_hashes['cffi-1.15.1-cp311-cp311-manylinux_2_12_i686.manylinux2010_i686.manylinux_2_17_i686.manylinux2014_i686.whl']='9569fe3f3af46c7e19b1bca00684856825bb663adf2cf669980b7c003535d278e05b53ddf85004dae01ab7ec582e721a2c8c6087612da438d0445bfd4ac1a241'
dependency_hashes['cffi-1.15.1-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl']='04fb957a7e40d10461e290b631aeaa02eb9a304ae0397ea5948fdb9de3c8376e2030385fb5bc5696b618659022250bc9a69c4f1b8ef1e637431fbb5d23b26aec'
dependency_hashes['cffi-1.15.1-cp311-cp311-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl']='d993a2f25c194c16c981583c86ee9de5374cec0602da6f681f655a18c92c51133babbca0c802d02f330009ccab5040bc0e4f7a4cb5cbb05eafa744e93f5c9c3d'
dependency_hashes['cffi-1.15.1-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl']='c27677ab98eccac495e34e912c5626eed909b72bf8d21493a3c00bfaaec0af7847d91a97fcc5d2834305e6c3b64fb2e4d84c83f7b6dc27b6a165c9f42bb5ab08'
dependency_hashes['cffi-1.15.1-cp311-cp311-musllinux_1_1_i686.whl']='9911acb9878bbc8c59734839c8cbc164e8f121a493a0589898e1b16df32c41d46d0132ac3a8a36d52cd2f0d857695a8cc6878b5cf6607fb52fad139a43089d66'
dependency_hashes['cffi-1.15.1-cp311-cp311-musllinux_1_1_x86_64.whl']='a8cd7b5b695cb89556a7b5c0d4f7d02325d39cd59bade9e6828717623c98c4a4fd5561366549770fc8e412aba06dd5c0cdb5934a49050d182bc27d0a8b4d5601'
dependency_hashes['cffi-1.15.1-cp36-cp36m-manylinux_2_17_aarch64.manylinux2014_aarch64.whl']='fde7e4cc649538a32c87bd40cc6f5596d79566c6508e2fa7c30241d68d7bbd51d22b50039910c5a5196f10f4c9d499eeb884367156f156dc8285fc3a1ac103a4'
dependency_hashes['cffi-1.15.1-cp36-cp36m-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl']='0c9980b8f05e7105832ab5e481432f778a09631ce0fd1c09b9582a19f2b08ebd666b491ca97bb718a74feb80d3516998e3f112871ad2838fd4256e7a8eb39ebb'
dependency_hashes['cffi-1.15.1-cp36-cp36m-manylinux_2_17_s390x.manylinux2014_s390x.whl']='d372560553196445c3152b92f4afa011f61aa768825dd63b8ac8b9142481b1b86c97f6f683a92ae0a25e409503ff4ef159c74185dbbfe2a54b22426d9ca991f7'
dependency_hashes['cffi-1.15.1-cp36-cp36m-manylinux_2_5_i686.manylinux1_i686.whl']='9cf0bc15c1d820e45578943222655cc8db8416e01ee825c9b107963174b20f0a0b01fd8277c28d918bcf18eeb5f45de9c1a935210f9c0a2daa5b62f70d747a45'
dependency_hashes['cffi-1.15.1-cp36-cp36m-manylinux_2_5_x86_64.manylinux1_x86_64.whl']='bf4d6ed94fda20aa7760d2a7f0c1557ddd70dc90a2f0b2dd391bd274d37f09e298b83ff014e6f0820c6b47e70681db94a4197016bc33b89e01f9223f23403988'
dependency_hashes['cffi-1.15.1-cp37-cp37m-manylinux_2_12_i686.manylinux2010_i686.manylinux_2_17_i686.manylinux2014_i686.whl']='862d68482073f468f60d8f093a9f9b5c78562297f2eb36c84bce283a4a00e897d1731aef67b12b17551e373a668288acd32dcd49031fed5a8c621aa8c41fb0b4'
dependency_hashes['cffi-1.15.1-cp37-cp37m-manylinux_2_17_aarch64.manylinux2014_aarch64.whl']='36160d9d7c2f138b3cc1debe96365d57b0d204dac9cd7732ee6ab8890d9fc87700a50475336d79d60b26c1656295e26d27998cc3f9f6274613c84a64144c93b0'
dependency_hashes['cffi-1.15.1-cp37-cp37m-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl']='55ea36458d5c3c4a6f9b647215676fe8801704c6facdb65c55f445b4069ed3fdaf155daa8e371ed9f27937f57799e189f7402b945ec70bb85eaaa2f643c70945'
dependency_hashes['cffi-1.15.1-cp37-cp37m-manylinux_2_17_s390x.manylinux2014_s390x.whl']='bb85c0f097eb69d218498dd07f4a40d5bbe280b11062babe64b8d3b9a0df540c42d95e898ee409b14daefdf19c48bc499cec6bb69295d7b6a10dc151fdd6bb6c'
dependency_hashes['cffi-1.15.1-cp37-cp37m-manylinux_2_17_x86_64.manylinux2014_x86_64.whl']='e253ae455ca94f91ee37038c225d395b5668e26772edf26de226ccbb347c3c1b5536a358e023779fc1b06bb6c5717158d6262855445804b1206e07da3a596c7e'
dependency_hashes['cffi-1.15.1-cp38-cp38-manylinux_2_12_i686.manylinux2010_i686.manylinux_2_17_i686.manylinux2014_i686.whl']='454522b8eef53c0d17a5eb24a8852f5d6d8360aca2a2c5cc8fca22533de548052ac4556c7cde432592b20f63cec0356be423a4a964ad046744e018821aee4ca5'
dependency_hashes['cffi-1.15.1-cp38-cp38-manylinux_2_17_aarch64.manylinux2014_aarch64.whl']='f529bc89cee24cc8db6888df904f5c2bc6a6ee9b0cd52ad03493918936079875fc0968a3f5f1e93306a41e6418d3e60b2b1417c287fc29d0c12951caa0b94b98'
dependency_hashes['cffi-1.15.1-cp38-cp38-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl']='2b0fba3366eaaf1a88701c5131fe6318e3c89c2969afed5fd2fffdcaea1810b91963dec37b549795267577a4f1697996846e8d027b63835e290c72b3568c8269'
dependency_hashes['cffi-1.15.1-cp38-cp38-manylinux_2_17_s390x.manylinux2014_s390x.whl']='88d1f27641ecbc51d9c323a19c913818c478d4eb87d27d16426d20eb9727d5d4b23bf9551d842433820068e29082c9b9c2654f38e903b6fc761d70632731c643'
dependency_hashes['cffi-1.15.1-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl']='7d21ff025e620b024191e0a813a678b3269b582e61944e5677eef4bd94be8456758515288d48b85b3736efb84b9d0d899d60bbf8c5d9e79f943c2b1f2f78f85d'
dependency_hashes['cffi-1.15.1-cp39-cp39-manylinux_2_12_i686.manylinux2010_i686.manylinux_2_17_i686.manylinux2014_i686.whl']='c76d6e2f761582c4122cec8ecb302fca324b90fdb3ad1442dfd32ab8cee25c6e0519c6556911d5d068229d48578f8c1cdcad4fdfe8bf936ed6038d020633a3e7'
dependency_hashes['cffi-1.15.1-cp39-cp39-manylinux_2_17_aarch64.manylinux2014_aarch64.whl']='7866aba126d54d88a0e55c70fc8587773fa1926db1f09c932b58489a63092b2e672f8bd3104d682bf41f250dfce85a824b2616b9f2cf796e020b1ddaabaacf4f'
dependency_hashes['cffi-1.15.1-cp39-cp39-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl']='228a40447e3cdf4bebec7286d8c53139f4dea816be3b378dec81ba5e0bb1c20a938564b0b6d34780399f79fce3ba572a5fb5e93dd21dc536551323290ff2483c'
dependency_hashes['cffi-1.15.1-cp39-cp39-manylinux_2_17_s390x.manylinux2014_s390x.whl']='c637580d319c9960185f44580932996c2554fb0e549d822f636a9703a8e9b8f6e105d765b65e1ef7411320698d05a60f4005b3d590e18c5784d5c8d07d86f612'
dependency_hashes['cffi-1.15.1-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl']='95bd8ee4ac5d3f4cb09d5d223dfec484cfc90b82e2eabe40eb3c89217b0f315bee469dee6c5f89bb02e636eefade048e6e709f2b5126eeb634dcb0cb13332fa6'
dependency_hashes['cffi-1.15.1-cp39-cp39-musllinux_1_1_i686.whl']='f5ea1c8a22ed5bfe03586d7fa872dc0bdeaa13ee310ecfd7355ca2a3f742ac6e3b3e2663399acb4220c95cdb92521dc181fd9c7d9da1ce45817a145500cd9243'
dependency_hashes['cffi-1.15.1-cp39-cp39-musllinux_1_1_x86_64.whl']='0fab1b5323e009dd41de28f3f5c9f01dd4ceea627de8bb6244f72394c3fbae6dca8dc65909dce4847cbf8fd3654b55b55caa194672652a253bd0fa2a1b112f78'
dependency_hashes['cffi-1.15.1.tar.gz']='e99cafcb029076abc29e435b490fa0573ee2856f4051b7ca8a5b38cd125d56dd9dae8b189f59ceb3d728a675da8ee83239e09e19f8b0feeddea4b186ab5173a5'
dependency_hashes['chardet-5.0.0-py3-none-any.whl']='7cd0bad8eb90218cf6ffd85a8b049b0016a0fe3df3d1f66062244d827d3a915d17b949408533296b55cd318d77fcaf732f39aeb1341a1ae08e287f09770e1a27'
dependency_hashes['chardet-5.0.0.tar.gz']='3853248584d53d977abe0e6ab856e1526fd7360d9b94b4f08d03895da80ba9efac8882dbd3f919f0d52b0699c0d7fd68edb223c37512685976c6f2b212fbe0ff'
dependency_hashes['charset_normalizer-2.1.1-py3-none-any.whl']='fe2f3ae5d3c011b314a057456a7b13ba957593b22dbe7f532f9fbe077103e75b3f8b631fb1e2a4d5875a60af678b6779780eff7df0ea7c08144aa88fce34abc0'
dependency_hashes['charset-normalizer-2.1.1.tar.gz']='f52abab683ebda4100d67ec6ee0349713baee453a742d60a1356f405c5ce2c3b4d850b0891527f08f92fa1217d59c46d6b181dc4ff1b962ce60d9c5ef8c913d1'
dependency_hashes['click-8.1.3-py3-none-any.whl']='ce7e25725b3edfd0f336f3ebc8ace3977539f0d063f3439c4a1af517263cc1058cd9c0f687819ba319811dd0f376148372444dbaf082797d1dfe2c1c1c856dfb'
dependency_hashes['click-8.1.3.tar.gz']='be5b0c8b72ef7c10854f31406668ca4d6f826381deff10bb6a87a406166c09af97e2165f1327094d96abade15efb872892af37f20fdbc855b659cb2c7bd2f2c5'
dependency_hashes['cryptography-38.0.1-cp36-abi3-manylinux_2_17_aarch64.manylinux2014_aarch64.manylinux_2_24_aarch64.whl']='9a91653297faf00869d17ac92efd423bfa26336a67bde586c95400cf0c3b4583eb12b1df53bec2e9163647e54a84a4daf2a7acc4c11573f29bfaca83a238bf93'
dependency_hashes['cryptography-38.0.1-cp36-abi3-manylinux_2_17_aarch64.manylinux2014_aarch64.whl']='617dbbc09da7d84e94df2d4e1f3594094dda123eff42a2712ee29a2a79475daaf9b8a2b68763f274c1595c2212bc295c26035f5c56502e5f7d7ef9884400af83'
dependency_hashes['cryptography-38.0.1-cp36-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl']='f248ed841d5c291c853d6861217476f30b060bde8d243feb3ad76a544a1c69a287e4e10a54ac839414012a0abff3c75a7b1e1ac07ed995cd99c1c6e06c00c354'
dependency_hashes['cryptography-38.0.1-cp36-abi3-manylinux_2_24_x86_64.whl']='960879ce1d3d6b74dcf64f0770b26d990edd20cc5e79f1fbc010ed587c1a8d102188b2b404b240b2b265ef16078812f18d0a318e574e7fd6a64db367e7e6f63c'
dependency_hashes['cryptography-38.0.1-cp36-abi3-manylinux_2_28_aarch64.whl']='cde1e7217b822a5bd1043b1c5cd86490f95a554c45d7ff345b2cdd0fed92c251980a1b2c06beaacee572e32d797b6a4eb1dc30206cf41c03cf1f21335669a501'
dependency_hashes['cryptography-38.0.1-cp36-abi3-manylinux_2_28_x86_64.whl']='605e2c1ddf74ef72957791722e36e04a6127906219ce00d982cac7e91397b4e7eb71ea19e2dab8d48983db4b0d0a5c743131e716560cce5f067043365a1a84a4'
dependency_hashes['cryptography-38.0.1-cp36-abi3-musllinux_1_1_aarch64.whl']='85eafa04591b2267cb6cbce9d422278c5613b39253e37a762a9939054fe8dcb431760578b6833fe7fef5304548ace32e36c0bc1d1fb4c49b446f4a0412d8cc77'
dependency_hashes['cryptography-38.0.1-cp36-abi3-musllinux_1_1_x86_64.whl']='6f7535dd9028e9fabb09c1a0820238a1871f5b6d8424373b64403c680cb5d6227a8f079109e814a366bbf13552eeef974b58d004f6a31f2a8c9da228c16bda64'
dependency_hashes['cryptography-38.0.1-pp37-pypy37_pp73-manylinux_2_17_x86_64.manylinux2014_x86_64.whl']='072285023be38da6db37d1d7b142bc34aff80f852879ae4f605ebb355ea25cb6c2a7f0d4b94a4546954413fa7553b28bb47771f825f2af37867757d1146763b3'
dependency_hashes['cryptography-38.0.1-pp37-pypy37_pp73-manylinux_2_24_x86_64.whl']='a254fea024f528d43d1f78b0a52b33882a6facffd760bf1246e5ea430e749bd1fc3703c01bc26e5cbd682cc3b5d6ce8b58d77ea6adf624bb9ea7d75101714f3b'
dependency_hashes['cryptography-38.0.1-pp37-pypy37_pp73-manylinux_2_28_x86_64.whl']='e88f97582b22fe60d9ce2ae1e66114acbc1504d5363a009f1257ac288e2ce840b4acc01594f49e37bd831c397f1f3c79f1a41657c67d585dff1b9bde9753de97'
dependency_hashes['cryptography-38.0.1-pp38-pypy38_pp73-manylinux_2_17_x86_64.manylinux2014_x86_64.whl']='3fe51ca3af63ec077c5d2957fd1e566ec82f92c6808ff94658c0e9d4acab168ec3a5c4e2aeefeb0330f1b1add711857de4df7cb68b1c813d1d4490edbed49017'
dependency_hashes['cryptography-38.0.1-pp38-pypy38_pp73-manylinux_2_24_x86_64.whl']='437026a6f0126fef74b7c3bdb1c2bebb38642dcf2314dcf55607bed574001b25d6f04d68de37fb09f51aa02c5ba9d623e6374f692ba30aa06f60c0d8470a82bd'
dependency_hashes['cryptography-38.0.1-pp38-pypy38_pp73-manylinux_2_28_x86_64.whl']='c3bd52ea954dc7f04a74448aa984cb7c32e40b5a16db053bd7a30c35d66d27b6011b843fe72fa90a6ec5052eb93ba0944fa12044d5411b2a039b060994b4ebed'
dependency_hashes['cryptography-38.0.1-pp39-pypy39_pp73-manylinux_2_17_x86_64.manylinux2014_x86_64.whl']='a12a61d786d2865956d166b5a35dd541bc9274dd95764489ed8a61167df880ea3e373c6ad9cc9e7c56302c9611224542f73d96162ee0f0ee4507195a0f2ecaa8'
dependency_hashes['cryptography-38.0.1-pp39-pypy39_pp73-manylinux_2_24_x86_64.whl']='896a24cfa4ce30f1981175c342fd7538942a34c62ccf053959215808746d1cd486b8e833076be380941e81c9a8ef5436b05ec953782e7bdacadc5c23c967dc79'
dependency_hashes['cryptography-38.0.1-pp39-pypy39_pp73-manylinux_2_28_x86_64.whl']='fd36ff7ffa504cc7bd880e104922fde45072a2d3f61f185f4baa20a3a32f6316cbb777852c6cf62284e7e684d150502fc468c63de8d0afdbf2a400ca45fbaf4b'
dependency_hashes['cryptography-38.0.1.tar.gz']='a0e9eb645888a74e01377c0ed79427d066a50d10a9b628828195e82b7ee44ff59866f3659f2028541856bba818340c404e00061645c2676bc63f8ece42fd511e'
dependency_hashes['distlib-0.3.6-py2.py3-none-any.whl']='7046ad8707013371b68a805fb437e7f29d883694d6870012f2db197f8bdf472aa262d5e549852c4dbccbd5af5cb0a402d60f8cad845e43df9429a2c437e28187'
dependency_hashes['distlib-0.3.6.tar.gz']='27f3a59f9175a92befb9a65a66cd0b8eb65185dab6fa13ef94e85ca69c2bc1b7281ce1522601034007cb98677ba9237a46224df4adc70ed966db7e131e073636'
dependency_hashes['filelock-3.8.0-py3-none-any.whl']='50b2529305be50e9f1e1faf3a2d38133f65d71b15aed767b167b48350487fd4d83cb03e1a6b460362d34b6d5a8fcf2014162d8626ae513a4a068e804a63d3894'
dependency_hashes['filelock-3.8.0.tar.gz']='95fb4d420a316199a658e20f385d5eec9db9398a78803cad581f73efb136d2935308a04b1bcf6cebd71a8601f72d006a491937664ec0b70904c305c5796a4bf1'
dependency_hashes['Flask-2.2.2-py3-none-any.whl']='d62d8b20d59c0ceee13538ca85c23581491c7686ceb53cc11e518e9e92f500369d87a09ce80804de193d501b6122592d40f3600bb222fec77f47dda78f5b2d82'
dependency_hashes['Flask-2.2.2.tar.gz']='d330398829cb0393e07a4dcf495a3939f0e8f7962c0a517fc866d333425dffe1ce8fd26e39a40445259028d46eff4566e97b3f5eba0d6bddf14b9d7bac138945'
dependency_hashes['idna-3.4-py3-none-any.whl']='ffdd45326f4e91c02714f7a944cbcc2fdd09299f709cfa8aec0892053eef0134fb80d9ba3790afd319538a86feb619037cbf533e2f5939cb56b35bb17f56c858'
dependency_hashes['idna-3.4.tar.gz']='4060a9304c9bac04efdd0b97ec8f5aeb7e17417e767bf51c5dfc26605edad25ab67456cf6f6a3c5a9f32b8247e46f6343edfd8a6ffbcd6d1075c71e66d089d6a'
dependency_hashes['importlib_metadata-4.12.0-py3-none-any.whl']='8cef31711b7b3f1e078cc223e1a579764aa5d52af47a4344f212d030655e8cf6b2d6f01eab73fbfb7457e4ad5bc9d3f3fd21f6f5f706cbb463c65b4d8b0ac25a'
dependency_hashes['importlib_metadata-4.12.0.tar.gz']='a7e3b8876665880a42bab885014199eed90efafcb386b89fddf62f3a6dbf51b192a0b9d208a40fd1f8b6db9d1bf80cf6d6753c1073196daa54dffa22a627443f'
dependency_hashes['itsdangerous-2.1.2-py3-none-any.whl']='190df7f250b5e5985898a7f0e0e9d4c3d0b5c391268b9b5ad0f39667ec887b543651dff7623ba49e191ffadb42b0354b21be19ef61a1f68193924bf12034dd1d'
dependency_hashes['itsdangerous-2.1.2.tar.gz']='e4d870a33992b309ed778f403c0c1e098983a693d1165260748bf36385ebfadb583811e05ddd48001a33cf6a4e963b7dd8a8c68919c5b4b86f63621d8869e259'
dependency_hashes['Jinja2-3.1.2-py3-none-any.whl']='00558cca2e0ac813d404252f6e5aeacb50546822ecb5d0570228b8ddd29d94e059fbeb6b90393dee5abcddaca1370aca784dc9b095cbb74e980b3c024767fb24'
dependency_hashes['Jinja2-3.1.2.tar.gz']='5dfe122c1beef5305b34d25f22f96607bd3a6cba098b03091850ea36fefe62b645a7218d7584b35bea252393ac922c9bb3654a9e90f23bcfb273e811fcf2f2c1'
dependency_hashes['MarkupSafe-2.1.1-cp310-cp310-manylinux_2_17_aarch64.manylinux2014_aarch64.whl']='efb6cdb81d325aca18c959d41a67b3a749ecb3bc4e558b50bccfb2a8e4924630d3bb3b6d409563644df93a632cd2c4f85ffbfd0c017d00b04333d14d1dd11564'
dependency_hashes['MarkupSafe-2.1.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl']='28f5696ab9bf80e7a0642ae13c02f6444d86cd36f42b711aa391147354894932d6ccbb530f6843a8051b1a35dd61c98ad2334620187e0720d789609102667c53'
dependency_hashes['MarkupSafe-2.1.1-cp310-cp310-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl']='520795cd64867914a593ca88eb64647f6b8851183fc952985f007bde045a203d200e47197d62987f733083513b068da8bcb10b3784d72505126f34cc455c3d53'
dependency_hashes['MarkupSafe-2.1.1-cp310-cp310-musllinux_1_1_aarch64.whl']='b9bb2596f0e60c3c7dbb2b53c97108893818f59f384ff657ff0498ca81d2e7e217c5b1a71b7403239cdf1993f0ab662f6ea4373ffbf20712ef3cfd222dbe1a52'
dependency_hashes['MarkupSafe-2.1.1-cp310-cp310-musllinux_1_1_i686.whl']='d847e5ba15e748ca64287c099c5760b067710729d5f70ecb58eae64f2b36fb68b324cb311dd9482c3ade7d4f055c895362b1cdb6591dda6bfc7fa251db018193'
dependency_hashes['MarkupSafe-2.1.1-cp310-cp310-musllinux_1_1_x86_64.whl']='b96b31a8079aa102aa35c80b5be0de5bc29bc08c2e232c455b531fc4b4291f9009073cdf8cd21f20f3e033f20351641807cfd0a58af8722429982728542a7ce1'
dependency_hashes['MarkupSafe-2.1.1-cp37-cp37m-manylinux_2_17_aarch64.manylinux2014_aarch64.whl']='14db30ef8f6d6c309efd6401ac8b58d95d795ca8df1d6e32ff580207249cbfe6e194e731a6bd214a37692afccb1efefbcff65c1a11ee9cd3dc637eb2f3f45916'
dependency_hashes['MarkupSafe-2.1.1-cp37-cp37m-manylinux_2_17_x86_64.manylinux2014_x86_64.whl']='e30f38680270b08d060a941bbd2bd71e1a69ee56f451edd38927e8411b3c3e03fcab9a85c432d555495cfb7470fe4b5d061ecc190bc66994bc700a370e9138e4'
dependency_hashes['MarkupSafe-2.1.1-cp37-cp37m-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl']='67eccfa67c6af21088e04a9c732078bf8f902eee327e51ab5db8ced5e1ecce8e2029f5699166249eac5fa1d432113de064eb1e45b1cbd542b9a70baf446162d7'
dependency_hashes['MarkupSafe-2.1.1-cp37-cp37m-musllinux_1_1_aarch64.whl']='d30a01de848c4c1dbf21dc5f5328d7ff81ee86375ef6db71f6fc37ebb3eb76c1f9ef7c1c28bf16c9960ac171c4768122e430bfa15333268f135d3f33dccab202'
dependency_hashes['MarkupSafe-2.1.1-cp37-cp37m-musllinux_1_1_i686.whl']='04a6ffecd43b9da63e7002b5a79068daa2749f46a093a2fb8d13ff720536006732a99480075806ec8953b70e0d5aa6c345a5c62ef066b09e3b148668f9aafc01'
dependency_hashes['MarkupSafe-2.1.1-cp37-cp37m-musllinux_1_1_x86_64.whl']='d1080481b86770d29dab97954e846a4508e702d71dbae632ca017ba8e406d9f7425d15c91141c148a94df62b02dcf3d6f07fba2b23b0322ce8d464c541505cf6'
dependency_hashes['MarkupSafe-2.1.1-cp38-cp38-manylinux_2_17_aarch64.manylinux2014_aarch64.whl']='b4822e17715118aa6e91f2cf162d000cf9f50332dfda7dde0faf7759d9a6d6e1c0baec166c5dbd22e05f238ead7ae5bacd684b1cfaeb3b2d1dcddda1c2665a63'
dependency_hashes['MarkupSafe-2.1.1-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl']='7329b15a5e9bb664404728248912ba6639c68223f78af2a19bffc6a0421f7de8b1f9c94f12ae9be8e1f982272414746c048ad4754168673c6b61a702e4fe0f33'
dependency_hashes['MarkupSafe-2.1.1-cp38-cp38-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl']='45062ba8578d4491ba0ac6001cb5c6de309e8441f7f84ffda8a9832d7db897236f71670fa43e7b9ff9cbd2fe9d291125fd701b3f979ebe222df43c288412d187'
dependency_hashes['MarkupSafe-2.1.1-cp38-cp38-musllinux_1_1_aarch64.whl']='e78729072d14312e2080a446d4d263fa3d6c7573e26f1101e0a6f918eb8098ad67919a4c978911f50af841cdc7291073c5aabca288f1b494be5ac62696ffaea0'
dependency_hashes['MarkupSafe-2.1.1-cp38-cp38-musllinux_1_1_i686.whl']='985e40ac643eb5b2bc60a4e9e45e8199a08c3044b06db2e32d5ed1fbf3026ab1a11ac2627f35a8ba36337a21eac34a438aa2eb559df3bee4969847c9d692045f'
dependency_hashes['MarkupSafe-2.1.1-cp38-cp38-musllinux_1_1_x86_64.whl']='ed90ffd217bcfa2bc071b0d7ba1bc6c73235fbcfce9d75260e63e8d4dc249ad21623b573e414c70ff62f4fa36131e4db35af359c1ed7fcdd628c7571a7c8942f'
dependency_hashes['MarkupSafe-2.1.1-cp39-cp39-manylinux_2_17_aarch64.manylinux2014_aarch64.whl']='3577ed92200321a5172c84a3c231fd240964094e242b4ebd3a8097dc310cec227e90179650f3def3d4bc476042ccb86ff5f5c55dae4ea63520ae28b74840c5a1'
dependency_hashes['MarkupSafe-2.1.1-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl']='cee65ded08fd20e3582c43f643fbc4f67b8c49c9e9c013ccfcee8e8e84e102545ad539200356c83ead2d78405719e177f52d00837602e932eaa8072643fa711f'
dependency_hashes['MarkupSafe-2.1.1-cp39-cp39-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl']='3c86b0149dcbec564ab4fe8b8cafef8643a121e5e5e7ab97f0d946716fc33978b1a4594748be52ef50eab9dbacc9bd7b94af4348b0acdb64f59fc29ebdbf5d52'
dependency_hashes['MarkupSafe-2.1.1-cp39-cp39-musllinux_1_1_aarch64.whl']='f3695f053cfde58e1c11105c76e521911b63cbd6365519f0ab352a1794c902bec68b84e3111f9bf3ac283ef0ac353667801aee43dabbdeffbf09f3694142005f'
dependency_hashes['MarkupSafe-2.1.1-cp39-cp39-musllinux_1_1_i686.whl']='133e313fd4aac1bbaaa9ed4e5dd246da4d79bf8d5f23f10eb833f2dc268bf3dfa4f83946b2eef171a62de2607050439bb0273bd83dbe0591bd585162a61e7e45'
dependency_hashes['MarkupSafe-2.1.1-cp39-cp39-musllinux_1_1_x86_64.whl']='7c0cec6c649f9d522569b47bf24fc2a09644ccc71250242b1c2edd0b751c67471a3f5c7e77a2d4055fb15c3b2e14ff2f435ff7150e49fe76a676f1346e5cfc94'
dependency_hashes['MarkupSafe-2.1.1.tar.gz']='1d9bf55614b4e0aeca726ebda7bab2829452212f03f2295efdd0340f3dd05eefc9733d6dd0e37f0d06a432ce00ed7d06b28c9e817fc25212675006577f468b3e'
dependency_hashes['pip-22.2.2-py3-none-any.whl']='142d3144c14b692c645613d98bf35dd91193128d5e21b61a8a702548f1247fac662499d6e39b65c0aa9a0444d2d92983fd8c410439796626485a4e1be99a102f'
dependency_hashes['pip-22.2.2.tar.gz']='ac782df874288d6435bd891361fa38cbf5c2c01b01acfb6dfe1bfbc746e3b6ecdbc3cb31967e41399f042967acac0124284f8c0c51645d302d865629560d8d42'
dependency_hashes['platformdirs-2.5.2-py3-none-any.whl']='61784584b6d51d775a11e13123803202e04531ef455801943ef9b27c1ed8e9c3c9fb51f70954e4ab17cf0647b45778dd7587b645561edd6252359faf4d2a1a15'
dependency_hashes['platformdirs-2.5.2.tar.gz']='b0b0dee3ac4176e64f302b3d34e253b2e33784160051b9dafb563962e597df75f2c9f714c050d5bdeb1769a1f56c2878a47e9a42361596e287ae7b2afe870370'
dependency_hashes['pycparser-2.21-py2.py3-none-any.whl']='aae67923f45abd1d781d03e0ce848627a07e9cf4c61a89bf32f1b5f638ceda08de39a038c46ed29d2df967d76be4f2572346bad087ac32b418e6fe654fd28e43'
dependency_hashes['pycparser-2.21.tar.gz']='e61fbdde484d1cf74d4b27bdde40cf2da4b7028ca8ecd37c83d77473dab707d457321aecaf97da3b114c1d58a4eb200290b76f9c958044b57e5fed949895b5f0'
dependency_hashes['PyNaCl-1.5.0-cp36-abi3-manylinux_2_17_aarch64.manylinux2014_aarch64.manylinux_2_24_aarch64.whl']='853446c38ce5488e18eba166f67650bc4f50044f509987ad2ae4830d2ed85284f057c3a4304180ad265bc33fb9cd6570488a37e40bade5e202ba201ad368af84'
dependency_hashes['PyNaCl-1.5.0-cp36-abi3-manylinux_2_17_aarch64.manylinux2014_aarch64.whl']='d3f24397a6a3a7a56652a56c8e8cfcb1ebc167b0d2dfc38c450d8fbc363b2b5c1226e58724a692b16a7e4f1022bb93e904664ff54640bba28720134058e2275f'
dependency_hashes['PyNaCl-1.5.0-cp36-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.manylinux_2_24_x86_64.whl']='c3502047add3590c1a1e60908e21d62455e2b4ba2f2efaf0f5118bf915934de9604d00036b3215ed54890a51a088872909409b296141d6241159c119d751a947'
dependency_hashes['PyNaCl-1.5.0-cp36-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl']='01d38ba9cdebf0cc658b187a753f63065cea29ca757296cc1d40da4c2609b8cf96a1df1af7bb75bec61af767cee4ac6a20aa858ba060b4c61807800e57e53fe4'
dependency_hashes['PyNaCl-1.5.0-cp36-abi3-musllinux_1_1_aarch64.whl']='61e07a421705e5c1613cbc888ff594d7e3457090e9654280f2b6e54a84e5d6dcd56292fd3c47b86a59be6eecafa8f17ad5d710f45b7fcda9f57d9c7343328bc2'
dependency_hashes['PyNaCl-1.5.0-cp36-abi3-musllinux_1_1_x86_64.whl']='9720cfe64e70667804c197a1762db2985bf5893ae774418f50da9a3d31135b8935fd497c5fe4f92909f6e0ac70e3c5dd57f6322ab780d29b12741c64c0d2c007'
dependency_hashes['PyNaCl-1.5.0.tar.gz']='cea3e4556432588630382abae6debf9203c7f55da286509da547a7921e4dbad98c915743625c68e5f7187fcaf6d4cdaf7ed2ed3ba60bd4c10ae6e3f88608dc65'
dependency_hashes['pyserial-3.5-py2.py3-none-any.whl']='29bce14c59e60f54ce476d919c9b9477190ef6bb44a6102f71345840f5c0f1d0a323c4c3c302c5f380bfaae32cf04142ee528b6dd7184f17789632a31d5ecab6'
dependency_hashes['pyserial-3.5.tar.gz']='c8df5e50d952d5a6dcf1d9253a6ba953e9763c545a867da66c22c90dfa015aba0194f2a8f29a229d0a5f4dc8bfeeaaab8bcfda4066ed78a18b151bc05e6ae327'
dependency_hashes['PySocks-1.7.1-py27-none-any.whl']='3e0b1775c14fe091d10e30b03f7f0c770861152e493cf3a3143b0de01aadbc73f684f0d4305f1a694932d4bdcac8056c422437130640e19028cd9fba59ff0b3f'
dependency_hashes['PySocks-1.7.1-py3-none-any.whl']='313b954102231d038d52ab58f41e3642579be29f827135b8dd92c06acb362effcb0a7fd5f35de9273372b92d9fe29f38381ae44f8b41aa90d2564d6dd07ecd12'
dependency_hashes['PySocks-1.7.1.tar.gz']='cef4a5ce8c67fb485644696a23bf68a721db47f3211212de2d4431eaf9ebd26077dd5a06f6dfa7fde2dcb9d7c1ed551facd014e999929cb4d7b504972c464016'
dependency_hashes['requests-2.28.1-py3-none-any.whl']='c6f13c11fe91caba7e152792f45dc9bfe2cb544d713521b27e46f1b1e9df923f386d860b9343fb3b5a3bfbd4b50c80591e8f7c7380160189a2eaed9830d5fe9d'
dependency_hashes['requests-2.28.1.tar.gz']='c123ec07171c2c7c34e4173b97750adfa313b4312d91c0d58e4eb8750361604017e5b370c23ec886d2cbf704f9074ec5ad0fa9c2cd8e6f9521532adafff39d41'
dependency_hashes['setuptools-65.3.0-py3-none-any.whl']='76e3e7fdff90ed462bf65549b6f9745e51604dea45810cd75971751ec32e9e2fde4c28f29ab4c7cc2b53a6171dd705665795b0e43e18cbcc3e0cbc7560e8390c'
dependency_hashes['setuptools-65.3.0.tar.gz']='3c173b1e1a8dbbed0bf3bf600df1256aeabf1b9dec34d5f5d0b1429b0fe16f2aa61fa6c4f400a5b6da24b9d679954866b76e019130bcf2246b138fe017025de9'
dependency_hashes['six-1.16.0-py2.py3-none-any.whl']='656b010ed36d7486c07891c0247c7258faf0d1a68c5fb0a35db9c5b670eb712d5e470b023ffd568d7617e0ae77340820397014790d14fda4d13593fa2bd1c76f'
dependency_hashes['six-1.16.0.tar.gz']='076fe31c8f03b0b52ff44346759c7dc8317da0972403b84dfe5898179f55acdba6c78827e0f8a53ff20afe8b76432c6fe0d655a75c24259d9acbaa4d9e8015c0'
dependency_hashes['stem-1.8.0.tar.gz']='aa2033567b79aef960f8321e4c6cbc28105c59d6513ff49a9f12509d8f97b1a2e8a3b04dc28abb07fad59b0f6ba66443b92bbefa0d08b26038bbaf24f7f2846d'
dependency_hashes['typing_extensions-4.3.0-py3-none-any.whl']='6538edf5912e90287ea02716bad89efab407becb7c96cab8d01606e8a8f7e2418e5c7ca80943357c2b09411954e011f8505497fac5f2fc99f2ae611432d799bf'
dependency_hashes['typing_extensions-4.3.0.tar.gz']='69e4a393aaaaa45d20f32027cc35c77a950bf1f9b82f0eb2906a4b466eb319b867b5f53c0afc71ca613817d7e37d305fe73c50e93b1d4b389fdb8f1e4d5f8535'
dependency_hashes['urllib3-1.26.12-py2.py3-none-any.whl']='f391145925973e63003830ae9df0ca5335d07f807ddf9e50dd27358684c4cec73bd2b07adc695a91b6c626631abd564241efbb9c59190696d4a39aade6cfde9c'
dependency_hashes['urllib3-1.26.12.tar.gz']='c34bc2cb92ff5fb4e27948b6b8bf286d1f3993d8e399a7dc99e8c1cb07b364f16f9c8d6fc3e5e22e6f2d9285454a945174a9a1de3cb0fcf08e673ba316bc5469'
dependency_hashes['virtualenv-20.16.5-py3-none-any.whl']='629c0a0071fd1b80998bd538a0b5af8dfca8567ac1999c65c177a72838197e4ecb98156789f7cda24e3ade4aced1363f9968c86f3c5a34e74c5ee2bcfc541841'
dependency_hashes['virtualenv-20.16.5.tar.gz']='2d4f96057eb8fea5da07126bbc656306b8ebc2db1c82a84b784fcb82cd1959a571dc1f016dead9561e1d073a8b06e10f2e225d6484b363b960adaa64239826d3'
dependency_hashes['Werkzeug-2.2.2-py3-none-any.whl']='989e259788074a794b3b0fc33fdf066fef45014fc15a743216c98ab59f64c96766db02ca69e3753e39e280476ab57f7f2d2415fcddb95bac13ea9b916439147a'
dependency_hashes['Werkzeug-2.2.2.tar.gz']='b37a63ba1d6970b10ba17b87575c2d030ad6c4c00ab50669d678297b9801e319f4f81f98bfc2d89fc2e645c5e192dd81ed2d653c03dbaef06565de0bdac2bcf7'
dependency_hashes['zipp-3.8.1-py3-none-any.whl']='d81c4259c49bc8f67440d74fab51f488dedc518591b63231699f5c9d6ce2c5f7fa56a4ee2d44dc4fadddce0dc72781af7c8a018a0d95bcdf52ba3985d834d034'
dependency_hashes['zipp-3.8.1.tar.gz']='05639feb20c7e8d3480ce17a52115a85bb2f0706ee0c1b15589b7556bb914ef30a1a34fa743217694b753bb5e72095c90fab7dfee85f2dbf461347322acb4d2e'


# ----------------------------------------------------------------------------------------
# Package lists (the list must be ordered so that sub-dependencies are listed
# before packages that use them, and the list items must use the same capitalization
# as the dependency filename).

pre_packages=("pip" "setuptools")
virtualenv_packages=("zipp" "backports.entry_points_selectable" "filelock" "importlib_metadata" "six" "distlib" "appdirs" "platformdirs" "typing_extensions" "virtualenv")
tcb_packages=("pycparser" "cffi" "setuptools" "argon2" "PyNaCl" "cryptography" "pyserial")
requests_packages=("urllib3" "idna" "charset_normalizer" "certifi" "requests")
flask_packages=("Werkzeug" "MarkupSafe" "Jinja2" "itsdangerous" "click" "Flask")
tails_packages=("pyserial" "PySocks" "pycparser" "cffi" "cryptography" "PyNaCl" "argon2")
tails_packages+=("${requests_packages[@]}" "${flask_packages[@]}")

# ----------------------------------------------------------------------------------------
# TFC Source file verification

function compare_digest {
    # Compare the SHA512 digest of TFC file against the digest pinned in this installer.
    purp_digest=$(sha512sum "${INSTALL_DIR}/${2}${3}" | awk '{print $1}')
    if echo "${purp_digest}" | cmp -s <(echo "$1"); then
        echo "OK - Pinned SHA512 hash matched file ${INSTALL_DIR}/${2}${3}"
    else
        echo "Error: ${INSTALL_DIR}/${2}${3} had an invalid SHA512 hash:"
        echo "${purp_digest}"
        echo "Expected following hash:"
        echo "${1}"
        exit 1
    fi
}


function verify_tcb_requirements_files {
    # To minimize the time TCB installer configuration stays online,
    # only the requirements files are authenticated between downloads.
    compare_digest c0879330db51be52dba280044394eb693a340cfbc5ceca26bc3ada9e41cbb83bf112024e069dff2d4618f2c3b3a090a101fe97d99ba5e748c64bfcc0767e3c07 '' requirements.txt
    compare_digest 172607d04e4416630c2dbd48b3e5452591b7ed556aca379a682af5515a1325f8c324bb4e2fcdc4851bea72cc580986d4dfce19f73632eea8f92cc667d4f5ef79 '' requirements-venv.txt
}


function verify_files {
    # Verify the authenticity of the rest of the TFC files.
    compare_digest 53c9081940a16b4029c1c8394b453a56278a5300f511de1e1f40346c7979e36595a744eacf37bfc705872c3703bca52b0a4ef26ed18a3b6b9e7187257f0691d1 '' dd.py
    compare_digest d361e5e8201481c6346ee6a886592c51265112be550d5224f1a7a6e116255c2f1ab8788df579d9b8372ed7bfd19bac4b6e70e00b472642966ab5b319b99a2686 '' LICENSE
    compare_digest 86b1d7b2b899770483db804d4fb4cc99d77267650e9394abf7b07df7166d10e3ec56f14c730d0f2c91597fe1f7539ddc4cdf652ffae478c1bc407bcc78818ebd '' LICENSE-3RD-PARTY
    compare_digest 4124eca1fbf194a0d5065e7c4f04ee14b15e3d6790bd9211da955cbd80102b92c188197e6389843c46a35454220802de437eec75627591ada3fd4b21cdeaeab7 '' relay.py
    compare_digest d176daa818e46631db5a00d83d7bcfc4e64ed59f7da991c659712425d05d73112db923aa127b849eaed236dbf8208389a2ad1830ce94e53fbf1dbd3948159052 '' requirements-dev.txt
    compare_digest 0f725e16f70b7688cc889ab10a2dc170f7a6bec2502a2e4bff4cad8d9ba5cd8a281188fca613cdccc6fa5085d0645185abd1358fc1b18c3b41085f6015751650 '' requirements-relay.txt
    compare_digest 2462811b4454174ff1a2b3a83253131f383a88ab074b85205439a9845344c5cb0d2afa5eff1bd219a3a28fd582e47a8040a116a41d05c7561a817e810c8a0327 '' requirements-relay-tails.txt
    compare_digest 8d6a421e6bcf681e5bd29bbe14456528f52cb87488b43e2c14c93acb5bd936b916631d5994dec17548b6921a8a8238d4e998b60b206eea8133c069e0e2d2b5ff '' requirements-pre.txt
    compare_digest 79f8272a2ab122a48c60630c965cd9d000dcafabf5ee9d69b1c33c58ec321feb17e4654dbbbf783cc8868ccdfe2777d60c6c3fc9ef16f8264d9fcf43724e83c2 '' tfc.png
    compare_digest a533ae85629e72e06745b7543ac11ac9ab5e8a5b56cbc2094cbe05c9bd0bc35340409e3a788d79cb5608a6d6ba184c2791a88c382b1e45547122bf39cfa45e15 '' tfc.py
    compare_digest 62f26d2805570ee70fad3a076579a554008e7d9f2c9ff310f3bb5876d361cc03dbae7ab63b144ac215a35f920ac56d359481352805a356479d622ab00da15f7f '' tfc.yml
    compare_digest 400b567ab4b428377aef7628486f6eee39c554555cadbc929b60846f96d112dd1426d05d77e5d528c2d260b5d99e01aa77f3b3fe42b3829d3a07b3e425057348 '' uninstall.sh

    compare_digest dd2dc76c186e718cd6eb501985f3f8c639d303e44186c5f21ca8e8cf6a25b329c573ca489eda80877be51ccaa6b72b4e763060d0f0f27c0217e8c6b1016d75ca launchers/ terminator-config-local-test
    compare_digest 2cf6f610cb4bfa560ac68fd0e15716a2be924731501a860f005a3b6c93a80b1a6a4ca8063013fe29fd873387dc3f15ac64e28a16695f037a8e47d5c0e968f70e launchers/ TFC-Local-test.desktop
    compare_digest 960f9fdea0e984cccb8d3b8aec76835e41c835643edf4a586961fa38728d4dbd02b53de545323aeff88cedc7bf118ac30775d0464fb1868774f8dee3c22b4f25 launchers/ tfc-qubes-receiver
    compare_digest 0a232912d4de9f5b8a3bee67a853e3affbcd7182ee5e57dc24926b6abd10582ef0de7311efbbc75d56dc8fde8abf07bb3cb874e0f7814c1f92fdbda2712de0f9 launchers/ tfc-qubes-relay
    compare_digest 2e2505f1a381add4e9126aa621a1e659265c94c2a4d9ca34ce823e5cbaf2833e1f54ae2f46100cad10cc090ad4afd748addd3b31e269d4c81a3266db9d441eb0 launchers/ tfc-qubes-transmitter
    compare_digest d3fd3dbc75c80070bb4b074659cfa06da0759241fbc3065deb603121073bd80486ce916d79a0235f63822a6b8d52fef65a1be62ed1efeafe1a0d3d9d104f680e launchers/ TFC-RP.desktop
    compare_digest 00c81112d9e504b0ec79512f332e94e0cbced68bb3d4f252f86ead331beed07085762096ec97881e06256429b39e4555887475610fa2de306cdb12f12b9db8ce launchers/ TFC-RP-Qubes.desktop
    compare_digest d3fd3dbc75c80070bb4b074659cfa06da0759241fbc3065deb603121073bd80486ce916d79a0235f63822a6b8d52fef65a1be62ed1efeafe1a0d3d9d104f680e launchers/ TFC-RP-Tails.desktop
    compare_digest 714beccb5957a0f34684911e2e6e8f6693cd55ac66979cd7df8789591cc8000fe4cfdafb73404cd56435e1b55bcac2491a35d608baa7c9b8a8de1a47d3b035bc launchers/ TFC-RxP.desktop
    compare_digest 799edbc9e0df8727227d74b49b0210786b16e44c5b1638f54af97e0f9caeb3e041cac5f5234172752bfe0efc675775f8b1201d5310fb942adca61abe3713b551 launchers/ TFC-RxP-Qubes.desktop
    compare_digest cf4ccfd81e65fc7851456253563ee86298011bee95827c024370b489298413e481bea5903df10c18cd26f0462faf04259d6c79158eea4094b13d4e28d18f49e1 launchers/ TFC-TxP.desktop
    compare_digest 772e36aeec51f9b3be8ce50f4b55434dfbafe42c3f934e25cc40729ebc433d46bf82943f4c4c7a68b655c99be29910f13a3ad586162cea151ea204250ab4662d launchers/ TFC-TxP-Qubes.desktop

    compare_digest f3f48b48c6f401e57fcad1471c05c5ac34f66a8cdc3654f334c60dd8038d985b08d751c3a70baa529172b3801e7b0a73166b1a6b535bfc8c5da1b32f6d375e97 qubes/ service.sh
    compare_digest 028a53be09f96464a148b6b7693e4ec95835836acad5b5934f3992595b4fa34b5f0d55e34e5c0a3e099736c23aba72fcf3408e9980ffb4b3f7e7169e1b9d2039 qubes/ writer.py

    compare_digest 95993945b4254553725d05dfd5da5b37acf0ec658e9d6b66e95c1265f6e08691545af595b2e75a1fca1be2ac54ea91fe95112d0c29cabaf347f0383c1598dccd src/ __init__.py
    compare_digest 95993945b4254553725d05dfd5da5b37acf0ec658e9d6b66e95c1265f6e08691545af595b2e75a1fca1be2ac54ea91fe95112d0c29cabaf347f0383c1598dccd src/common/ __init__.py
    compare_digest 63885361deda2d5c17f5265c97d073e9999d5f6905afce1433fbc88c85d283d1b486c672a24dcc67d278f89b8dcec44d1d5db6fe8c5d52d4db4c0eb86121301e src/common/ crypto.py
    compare_digest a6ddf580fc6cff070002e0f7d10087662f2aec40f05ca6440b9f4b105621de4b122953a270e4ddcd2e61cc621414883f4c5344949c86b6ed9978b64363f58256 src/common/ database.py
    compare_digest 92bad70cb8f907d9107cb7cece117c4387dbb6c879c879f0311d475c437094088cae3f54447c31ca16fdd54ab9ec7fcb8607c54e5f50630e398b944e7a343262 src/common/ db_contacts.py
    compare_digest 93bb40019edb563a69f564872df4e80b571b1bc206994097482727ebef1d71401f028ad6ac6ab6843e5f6e065165a051449595acd36b6b3c8934ac75fcb56e4f src/common/ db_groups.py
    compare_digest b03b80d5f7a88896b6644354916edcb9f0a1cd3c0be12278e79d96ce36d0c90f5ce509ee1a3ddd90741aa0b2f8da4a80e1b7dd134151ca2b82f73eae5c726d83 src/common/ db_keys.py
    compare_digest 3ca8098d191af07daaa5dd74997f6202c22411f361e803d896db9de392d14d20a2e2705a90ce3f14c01efdc8c3596015643f95b3f8f3661cdda74f7118dbf54a src/common/ db_logs.py
    compare_digest 4ec996462231091054173382e8c9682e62b4b9bfba9c57c32237ea713f1fe3083accbac427acfc48c07a1f34d8fe4db94d33ceb08be873deedb3a66f72bd40eb src/common/ db_masterkey.py
    compare_digest 168d8f41a09c4401b32a49aebb4f84c4672580c53ec9873a566a933198d471ddcc03ad7d427868380d2f949b4bf7cacc9e7b88891a1634be4ced2675a0030464 src/common/ db_onion.py
    compare_digest 0db5a52a8d5ebcfcd29f58f68371a32a886822ea51a37da946ff28fe3e158284f1c8ebcc95efccf61aa6eda46044b60684fe346c4c9c3fce35c75503c0f643bc src/common/ db_settings.py
    compare_digest 087c1f8aefaa0d94703f5e93bd3aa1987bef47f28e0c23b5df306ecd8826827f65020c13ac4736244a60c3a6670ab075df49ce31738f52f2f78b10414fa2244d src/common/ encoding.py
    compare_digest acfb868e6d42b7d5bd9b39d26f31536f80a5d2e83bf15c468e890960fe6582cbd9a58c007d4a006d6b6f8c9befcb19b42014dfecf55776379f68cafce7275965 src/common/ exceptions.py
    compare_digest f2a32fe912a5806d8016aa2b877fa6642e2bffa72d4e989286a7de68f175fd2a54e88558e1f4d740cdeb9fe2eacea66f349ed8ad0cfb1cb22a1d32d0bcb14eec src/common/ gateway.py
    compare_digest af98163e8d21706a64417f4ae810476cdeffd5a74f4e84d234b23c8cf0281247213bcf253d7668f22d3ab1407c66b2a3907a9ebc0fe6027f684c71a9ebaca433 src/common/ input.py
    compare_digest ee2708020a9fbd28cba41193928c823ccc9fd098a9778ef8e17ddca84bf329a6b40d813448a4c783c193b8d985947af21a545a481cbfab4b86ee70475eb3d20f src/common/ misc.py
    compare_digest 4aac2ecbcbafd7efe87417e27e252beecee01c3ea00cc5721c34c1606efe0924e48ec8dc654ef09b7e94620291b793323cc9f32a961fa77c9b7cc116d4413a3d src/common/ output.py
    compare_digest d24053669a152dbc30c9896a30dea75d65bd64324cdacc9d00e8b4cc174bf7267f1706b1d50868d54dd100765f5545cd96967c22c98434cc51b3705d92e49170 src/common/ path.py
    compare_digest 333e495c3f3a7b8b9c4a30a1a81feceb77198b6b6afcc2ea523611e0c776d1b5bacccedec806ef78f1088d855168248df6278907bc97a5ad2f3dc84af845509e src/common/ reed_solomon.py
    compare_digest eddc3a8f64972d75888f7ce3c66cfd667d60daa49c69638856ef873f3c4c36b5987eb10431bc206baabe18809e98fc862cb4b828a515573a0a2c8bfa8f0bf536 src/common/ statics.py
    compare_digest e4bc967c49871a5660e34c8633a5e97e3d71aa87dc93e58c1451be78c67e876e2fc3f2ac056a7f7fec3f9ff348faf2384490593c8514ad4b157d5a4444c745d2 src/common/ word_list.py

    compare_digest 95993945b4254553725d05dfd5da5b37acf0ec658e9d6b66e95c1265f6e08691545af595b2e75a1fca1be2ac54ea91fe95112d0c29cabaf347f0383c1598dccd src/receiver/ __init__.py
    compare_digest 0f1a8ef05973e8ce15c7b1be47371377de3c6e9d1600466ef22208194ed4fdac17c725c4473df017fa17b8e5b5e58acd16baffc15537330d86524e079a4a4613 src/receiver/ commands.py
    compare_digest 1ecbc202400f6fcd04e4e9bdbf5adff54f1af637d7be59b102a11f9f33fdd65cade70c50cf4cbbfab14d4e6b19bdd5dfb6fa686a3d26b1d9d2a8d922435c6f77 src/receiver/ commands_g.py
    compare_digest 0705fda0752a3e9b45d217435885a061eda89adba2c41b9c96d7c10c106cc98434c1c2c43f3af45f64068b6a71973d47ffe4b6fe781ceb4a19af9fb59297a7b3 src/receiver/ files.py
    compare_digest cb8591d2fc7f50f6f0daf37b9ceeea7627cab8379de0c7adba8eaa098665cf2324fe88869bf0b552636709a5fa03deb497498c23d95d5ec4d69fe125f35fa37c src/receiver/ key_exchanges.py
    compare_digest 9a074ffa89f7e0d5045c4c5d7aaa8686206eb1d6c9769bbb32236e4d2af5f331115f7726a85952989944a768dfdf49035b6aa2d83ff1896682a855b70a4e337f src/receiver/ messages.py
    compare_digest ba31bdfe60ec50c0adc7fd06d960989ed73c3d2c02a3f4a96a0271a0fe9944758bf77ba83bf34e64baa6a05d40b6f2e0b17d9dfebe2766cd094b0fad80cc0714 src/receiver/ output_loop.py
    compare_digest 3633f7b783bc6a159c34e82818a0c10d0583071e8c7bc10a3416319e347b7328057387000c0701a889e7c1d98df50f8cb62e05a93a15c916bfa48a60909246c9 src/receiver/ packet.py
    compare_digest 9be3df08046fa6c5cbca070a78cf425bb60eb0270df75cfb122f786ad4eb398c563e5b5d40fb7be9a392443ec1bdccfbc754d9313cfed73136f4e8d77d4fc3e1 src/receiver/ receiver_loop.py
    compare_digest e4346cd4918618bb06c8a3416b7ba9f82f16bed8372c85f96a9669108677570daf36dcc6121543e8d83e336cdaedcd31f15065a68bd2af0b434f0cb263c61b20 src/receiver/ windows.py

    compare_digest 95993945b4254553725d05dfd5da5b37acf0ec658e9d6b66e95c1265f6e08691545af595b2e75a1fca1be2ac54ea91fe95112d0c29cabaf347f0383c1598dccd src/relay/ __init__.py
    compare_digest aef1d1caf622f81c6ddd0e390485ea21b8114cbc17c34e1430bb35ba05d9a1d46afc12c45a99f2d1567a2ab34edc2cc25140fef37dfa91b1fc7cb0dc12cc8b52 src/relay/ client.py
    compare_digest 271ae263192ba3408c67dce12c87333c84cad23e6753111566485d1f024cf532990ebabec6188027e26dbddbd67436aa82fc3f29ecb219b60a79ecde2b6c15fc src/relay/ commands.py
    compare_digest fe1cdfad24c34ce27e36784421a71de301cd259864169ecfde95ef30af29817ae805ee6aac4078cd1577f5651330712df1294c69096c1a804845cd5882591604 src/relay/ diffs.py
    compare_digest 56beb1b5242c45212d97956acfff11cbbea1e9e0de33a95f25d836ba48048e2f7e2da28581d56b22c83abab321013746ffa05de41b06903678a032151fc4d51e src/relay/ onion.py
    compare_digest cc66d739d351167d1b30900cbd81dfac9631c67d7500d0e9f5ea5a55f8b23043b654edb82db7708ef32f44563f06796cfc56eebe935695751727c7be0db5172b src/relay/ server.py
    compare_digest a5f72dc67e41bf7c3496b19fbfb4ed8b78c5b64d6d1ada9cf9206957312eb1fa9abd69b4fb7e22bcb650ef5159a6a17ea5a737ce32724d5b9124e96c88d0b2c9 src/relay/ tcb.py

    compare_digest 95993945b4254553725d05dfd5da5b37acf0ec658e9d6b66e95c1265f6e08691545af595b2e75a1fca1be2ac54ea91fe95112d0c29cabaf347f0383c1598dccd src/transmitter/ __init__.py
    compare_digest 79e791745e7af043e0011cff7fc868c0373b1cb5b66a28c4c61504d5e80245b0627d4ce9f9f8c6ab547e6ad22ab86a03c68e6b1a8ce57d66cdc0b6e6610c6205 src/transmitter/ commands.py
    compare_digest 1c8d0647596af5fed96caaaa701d7ab3101ae8d1e4696e14e57884c7ed26c596de09bd768a297b83db17778ff7f29e38fe545593a63af3d7dea31ce8eec4b3dc src/transmitter/ commands_g.py
    compare_digest 45f4a77376f06338b4fa3514aff41337633358fe65efc7220bb0cc00125049deae0b5ec5ee33b1ce367092915687ad2d094090b9afe70f09600be28a7a9703f1 src/transmitter/ contact.py
    compare_digest bd218503cb3e5e467cf02cb676426144caf4bd1811d647152e8ba5a6d6cd018517a44b7c23b6bd6b94d1cc79e39d30d2c8299ce1cb76f933b887dd44d77a2c43 src/transmitter/ files.py
    compare_digest 7876bbbda597f541a7f7b7f6489a45edf8b60bd3e7b7c0d91c024d911fbdd633f0541d5b1c48814a43957efba9955c1667d5311258c8065fb566274b8655fd93 src/transmitter/ input_loop.py
    compare_digest 1d4390c8e539798659a208b18e7355da86d7d47b52c5bf7f430cedb5a154b2d889ffd8bc763c5b614576572a70531162437f8666da6269063bca42e9153ddd1a src/transmitter/ key_exchanges.py
    compare_digest 8ea47fb7825b8ec988a38ef0e26da37e622b3489c3f2cc2e60ac1e7cd2258c1bca578eaf917aacb9301c8a2d2d81016f9420967db50bf44d3eb5087ea03cf157 src/transmitter/ packet.py
    compare_digest 369cd62ee0295791d75b683317fe9f8c312a35c28f50aa48530c77251f1fd1761a783d719aaa4611be19957f86c36fd4dde5394fafd3623dae31398179a4438a src/transmitter/ sender_loop.py
    compare_digest 896a364faa65425dbe0f1a2e4670742ed63cc0d053e8ced4d47fc67ba1e03f9fae707f0f0ac24f47c931b12dc81e8fbdbb306b2175d7a5a1e4f3ffee79c90cc1 src/transmitter/ traffic_masking.py
    compare_digest 76f187d9f870dcdfb42d0b226c4737efdcf7f0f5b9dffc2f9b760078f39d333c7e40ac080628b10525dc3e222b165b5aea670060864adfa24eb2202bb7263ef1 src/transmitter/ user_input.py
    compare_digest fbb6513fb8863e68d3442f4dc63b3c3e97fd1ab1ba44320d3d5b9093e0385a96c923d5909a1f33e2d91aeeb2e10863ed258e304e1d6082104b472930f10d3360 src/transmitter/ window_mock.py
    compare_digest 61527e42b96a78e47b3b2552f6086f4c8bbdfdad2f32163ac8d21a69f13e0db5169b4dba4498a1d2b745b70386c699c2e938e6f1e90acd92f9a425f2a208a5ab src/transmitter/ windows.py
}


# ----------------------------------------------------------------------------------------
# Printing utilities

function c_echo {
    # Justify printed text to the center of the terminal.
    printf "%*s\n" "$(( ( $(echo "${1}" | wc -c) + 80 ) / 2 ))" "${1}"
}

function exit_with_message {
    # Print error message and exit the installer with flag 1.
    clear
    echo ''
    c_echo "Error: $* Exiting." 1>&2
    echo ''
    exit 1
}


function install_complete {
    # Notify the user that the installation is complete.
    clear
    c_echo ''
    c_echo "$*"
    c_echo ''
    c_echo "Press any key to close the installer."
    read -r -n 1 -s -p ''
    echo ''

    kill -9 $PPID
}


function install_complete_qubes {
    # Notify the user that the installation for Qubes VM is complete.
    clear
    c_echo ''
    c_echo "Installation of TFC on this Qube is now complete."
    c_echo ''
    c_echo "Press any key to close the installer."
    read -r -n 1 -s -p ''
    clear

    kill -9 $PPID
}


# ----------------------------------------------------------------------------------------
# Installation utilities

function t_sudo {
    # Execute command as root on Tails.
    echo "${sudo_pwd}" | sudo -S "${@}"
}


function check_rm_existing_installation {
    # Remove TFC installation directory if TFC is already installed.
    if [[ -d "${INSTALL_DIR}" ]]; then
        if [[ ${sudo_pwd} ]]; then
            t_sudo rm -r ${INSTALL_DIR}  # Tails
        else
            sudo rm -r ${INSTALL_DIR}    # Debian etc.
        fi
    fi
}


function dpkg_check {
    # Check if the software manager is busy, and if, wait until it completes.
    i=0
    tput sc
    while sudo fuser /var/lib/dpkg/lock >/dev/null 2>&1 ; do
        case $((i % 4)) in
            0 ) j="." ;;
            1 ) j="o" ;;
            2 ) j="O" ;;
            3 ) j="o" ;;
        esac
        tput rc
        echo -en "\rWaiting for other software managers to finish..$j"
        sleep 0.5
        ((i=i+1))
    done
    echo ''
}


function steps_before_network_kill {
    # These steps are identical in TCB/Relay/Local test configurations.
    # This makes it harder to distinguish from network traffic when the
    # user is installing TFC for Source or Destination Computer: By the
    # time `kill_network` is run, it's too late to compromise the TCB.
    # Hopefully this forces adversaries to attempt compromise of more
    # endpoints during installation, which increases their chances of
    # getting caught.
    dpkg_check
    check_rm_existing_installation

    wait_for_tor
    sudo torsocks apt update
    sudo torsocks apt install git gnome-terminal libssl-dev python3-pip python3-tk net-tools -y
    sudo torsocks git clone https://github.com/maqp/tfc.git ${INSTALL_DIR}
    cd ${INSTALL_DIR}
    sudo git checkout development

    verify_tcb_requirements_files
    sudo torsocks python3 -m pip install  -r "${INSTALL_DIR}/requirements-pre.txt"  --require-hashes --no-deps --no-cache-dir
    sudo torsocks python3 -m pip download -r "${INSTALL_DIR}/requirements-venv.txt" --require-hashes --no-deps --no-cache-dir -d ${INSTALL_DIR}/
    sudo torsocks python3 -m pip download -r "${INSTALL_DIR}/requirements.txt"      --require-hashes --no-deps --no-cache-dir -d ${INSTALL_DIR}/
}


function verify_packages() {
    # Verify authenticity of downloaded dependency file.
    dependency_list=("$@")
    for dependency in "${dependency_list[@]}"; do

        dep_file_name=$(ls "${HOME}/" | grep "^${dependency}")

        # Move the dependency to root controlled dir
        if [[ ${sudo_pwd} ]]; then
            t_sudo mv "${HOME}/${dep_file_name}" "${INSTALL_DIR}/${dep_file_name}"  # Tails
            t_sudo chown root                    "${INSTALL_DIR}/${dep_file_name}"
        else
            sudo mv "${HOME}/${dep_file_name}" "${INSTALL_DIR}/${dep_file_name}"    # Debian etc.
            sudo chown root                    "${INSTALL_DIR}/${dep_file_name}"
        fi

        # Calculate the purported hash from the downloaded file
        purp_hash=$(sha512sum "${INSTALL_DIR}/${dep_file_name}" | awk '{print $1}')

        # Load pinned hash from the hashmap based on filename
        pinned_hash=${dependency_hashes[${dep_file_name}]}

        # Compare the purported hash to the pinned hash
        if echo "${purp_hash}" | cmp -s <(echo "$pinned_hash"); then
            echo "OK - Pinned SHA512 hash matched file ${dep_file_name}"
        else
            echo "Error: ${dep_file_name} had an invalid SHA512 hash:"
            echo "${purp_hash}"
            echo "Expected following hash:"
            echo "${pinned_hash}"
            exit 1
        fi

    done
}


function install_packages_as_root() {
    # Install list of verified packages
    dependency_list=("$@")
    for dependency in "${dependency_list[@]}"; do

        # Find file that starts with the dependency name
        dep_file_name=$(ls "${INSTALL_DIR}" | grep "^${dependency}")

        # Install the dependency
        if [[ ${sudo_pwd} ]]; then
            t_sudo python3 -m pip install "${INSTALL_DIR}/${dep_file_name}" --no-deps  # Tails
        else
            sudo python3 -m pip install "${INSTALL_DIR}/${dep_file_name}" --no-deps    # Debian etc.
        fi

    done
}

function install_to_venv() {
    # Install list of verified packages to virtualenv
    dependency_list=("$@")
    for dependency in "${dependency_list[@]}"; do

        # Find file that starts with the dependency name
        dep_file_name=$(ls "${INSTALL_DIR}" | grep "^${dependency}")

        # Install the dependency to virtualenv
        if [[ ${sudo_pwd} ]]; then
            t_sudo "${INSTALL_DIR}/${VENV_NAME}/bin/pip3" install "${INSTALL_DIR}/${dep_file_name}" --no-deps  # Tails
        else
            sudo "${INSTALL_DIR}/${VENV_NAME}/bin/pip3" install "${INSTALL_DIR}/${dep_file_name}" --no-deps    # Debian etc.
        fi

    done
}


function remove_packages() {
    # Remove the dependency installation files.
    dependency_list=("$@")
    for dependency in "${dependency_list[@]}"; do

        # Find file that starts with the dependency name
        dep_file_name=$(ls "${INSTALL_DIR}" | grep "^${dependency}")

        # Delete the file
        if [[ ${sudo_pwd} ]]; then
            t_sudo -E rm -f "${INSTALL_DIR}/${dep_file_name}"  # Tails
        else
            sudo -E rm -f "${INSTALL_DIR}/${dep_file_name}"    # Debian etc.
        fi

    done
}


function remove_common_files {
    # Remove files that become unnecessary after installation.
    $1 rm -r ${INSTALL_DIR}/.git/
    $1 rm -r ${INSTALL_DIR}/launchers/
    $1 rm -r ${INSTALL_DIR}/tests/
    $1 rm    ${INSTALL_DIR}/.coveragerc
    $1 rm    ${INSTALL_DIR}/install.sh
    $1 rm    ${INSTALL_DIR}/install.sh.asc
    $1 rm    ${INSTALL_DIR}/pubkey.asc
    $1 rm    ${INSTALL_DIR}/README.md
    $1 rm    ${INSTALL_DIR}/requirements.txt
    $1 rm    ${INSTALL_DIR}/requirements-dev.txt
    $1 rm    ${INSTALL_DIR}/requirements-relay.txt
    $1 rm    ${INSTALL_DIR}/requirements-relay-tails.txt
    $1 rm    ${INSTALL_DIR}/requirements-pre.txt
    $1 rm    ${INSTALL_DIR}/requirements-venv.txt
    $1 rm -f /opt/install.sh
    $1 rm -f /opt/install.sh.asc
    $1 rm -f /opt/pubkey.asc
}


function install_virtualenv {
    # Some distros want virtualenv installed as sudo and other don't.
    # Install as both users to improve the chances of compatibility.
    sudo torsocks python3 -m pip install -r ${INSTALL_DIR}/requirements-venv.txt --require-hashes --no-deps
    torsocks      python3 -m pip install -r ${INSTALL_DIR}/requirements-venv.txt --require-hashes --no-deps
}


function kill_network {
    # Kill network interfaces to protect the TCB from remote compromise.
    for interface in /sys/class/net/*; do
        name=$(basename "${interface}")
        if [[ ${name} != "lo" ]]; then
            echo "Disabling network interface ${name}"
            sudo ifconfig "${name}" down
        fi
    done

    sleep 1
    clear
    c_echo ''
    c_echo " This computer needs to be air gapped. The installer has "
    c_echo "disabled network interfaces as the first line of defense."
    c_echo ''
    c_echo "Disconnect the Ethernet cable and press any key to continue."
    read -r -n 1 -s -p ''
    echo -e '\n'
}


function add_serial_permissions {
    # Enable serial interface for user-level programs.
    clear
    c_echo ''
    c_echo "Setting serial permissions. If available, please connect the"
    c_echo "USB-to-serial/TTL adapter now and press any key to continue."
    read -r -n 1 -s -p ''
    echo -e '\n'
    sleep 3  # Wait for USB serial interfaces to register

    # Add user to the dialout group to allow serial access after reboot
    sudo adduser "${USER}" dialout

    # Add temporary permissions for serial interfaces until reboot
    mapfile -t arr < <(ls /sys/class/tty | grep USB) || true
    for i in "${arr[@]}"; do
        sudo chmod 666 "/dev/${i}"
    done

    if [[ -e /dev/ttyS0 ]]; then
        sudo chmod 666 "/dev/ttyS0"
    fi
}


function create_user_data_dir {
    # Backup TFC user data directory if it exists and has files in it.
    if [[ -d "$HOME/tfc" ]]; then
        if [[ -n "$(ls -A "${HOME}/tfc/")" ]]; then
            mv "${HOME}/tfc" "${HOME}/tfc_userdata_backup_at_$(date +%Y-%m-%d_%H-%M-%S)"
        fi
    fi
    mkdir -p "${HOME}/tfc" 2>/dev/null
}


function get_screen_width {
    # Output the width of the screen resolution.
    xdpyinfo | grep dimensions | sed -r 's/^[^0-9]*([0-9]+).*$/\1/'
}


function modify_terminator_font_size {
    # Adjust terminator font size for tiling terminal emulator configurations.
    #
    # The default font sizes in terminator config file are for 1920px
    # wide screens. The lowest resolution (width) supported is 1366px.
    width=$(get_screen_width)

    if (( width < 1600 )); then
        $1 sed -i -e 's/font                = Monospace 11/font                = Monospace 8/g'     "${2}"  # Normal config
        $1 sed -i -e 's/font                = Monospace 10.5/font                = Monospace 7/g'   "${2}"  # Data diode config
    elif (( width < 1920 )); then
        $1 sed -i -e 's/font                = Monospace 11/font                = Monospace 9/g'     "${2}"  # Normal config
        $1 sed -i -e 's/font                = Monospace 10.5/font                = Monospace 8.5/g' "${2}"  # Data diode config
    fi
}


# Installation configurations for Debian/PureOS/Ubuntu/LMDE
# ----------------------------------------------------------------------------------------

function install_tcb {
    # Install TFC for Source/Destination Computer.
    steps_before_network_kill
    kill_network

    verify_files
    create_user_data_dir

    VENV_NAME="venv_tcb"

    install_packages_as_root "${virtualenv_packages[@]}"

    # Temporary fix for pypa/virtualenv issue #2350
    export DEB_PYTHON_INSTALL_LAYOUT='deb'
    sudo -E python3 -m virtualenv "${INSTALL_DIR}/${VENV_NAME}" --system-site-packages --never-download --always-copy

    . ${INSTALL_DIR}/${VENV_NAME}/bin/activate
    install_to_venv "${tcb_packages[@]}"
    deactivate

    sudo mv ${INSTALL_DIR}/tfc.png                   /usr/share/pixmaps/
    sudo mv ${INSTALL_DIR}/launchers/TFC-TxP.desktop /usr/share/applications/
    sudo mv ${INSTALL_DIR}/launchers/TFC-RxP.desktop /usr/share/applications/

    # Remove unnecessary files
    remove_packages "${virtualenv_packages[@]}"
    remove_packages "${tcb_packages[@]}"
    remove_common_files "sudo"
    sudo rm -r "${INSTALL_DIR}/src/relay/"
    sudo rm -r "${INSTALL_DIR}/qubes/"
    sudo rm    "${INSTALL_DIR}/dd.py"
    sudo rm    "${INSTALL_DIR}/relay.py"
    sudo rm    "${INSTALL_DIR}/tfc.yml"

    add_serial_permissions

    install_complete "Installation of TFC on this device is now complete."
}


function install_relay {
    # Install TFC Relay configuration on Networked Computer.
    steps_before_network_kill

    verify_files
    create_user_data_dir

    VENV_NAME="venv_relay"

    install_virtualenv
    # Temporary fix for pypa/virtualenv issue #2350
    export DEB_PYTHON_INSTALL_LAYOUT='deb'
    sudo -E python3 -m virtualenv ${INSTALL_DIR}/${VENV_NAME} --system-site-packages --always-copy

    . ${INSTALL_DIR}/${VENV_NAME}/bin/activate
    sudo torsocks ${INSTALL_DIR}/${VENV_NAME}/bin/pip3 install -r ${INSTALL_DIR}/requirements-relay.txt --require-hashes --no-deps
    deactivate

    sudo mv ${INSTALL_DIR}/tfc.png                  /usr/share/pixmaps/
    sudo mv ${INSTALL_DIR}/launchers/TFC-RP.desktop /usr/share/applications/

    # Remove unnecessary files
    remove_packages "${virtualenv_packages[@]}"
    remove_packages "${tcb_packages[@]}"
    remove_common_files "sudo"
    sudo rm -r "${INSTALL_DIR}/src/receiver/"
    sudo rm -r "${INSTALL_DIR}/src/transmitter/"
    sudo rm -r "${INSTALL_DIR}/qubes/"
    sudo rm    "${INSTALL_DIR}/dd.py"
    sudo rm    "${INSTALL_DIR}/tfc.py"
    sudo rm    "${INSTALL_DIR}/tfc.yml"

    add_serial_permissions

    install_complete "Installation of the TFC Relay configuration is now complete."
}


# ----------------------------------------------------------------------------------------
# Installation configuration for Tails

function read_sudo_pwd {
    # Cache the sudo password so that Debian doesn't keep asking
    # for it during the installation (it won't be stored on disk).
    read -r -s -p "[sudo] password for ${USER}: " sudo_pwd
    until (t_sudo echo '' 2>/dev/null)
    do
        echo -e '\nSorry, try again.'
        read -r -s -p "[sudo] password for ${USER}: " sudo_pwd
    done
    echo
}


function install_relay_tails {
    # Install TFC Relay configuration on Networked Computer
    # running Tails live distro (https://tails.boum.org/).
    read_sudo_pwd

    t_sudo apt update
    t_sudo apt install libssl-dev python3-pip python3-tk -y || true  # Ignore error in case packets can not be persistently installed

    create_user_data_dir

    VENV_NAME="venv_relay"

    torsocks git clone https://github.com/maqp/tfc.git "${HOME}/tfc"
    cd "${HOME}/tfc"
    git checkout development
    t_sudo mv "${HOME}/tfc/" "${INSTALL_DIR}/"
    t_sudo chown -R root ${INSTALL_DIR}/

    verify_tcb_requirements_files
    verify_files

    # Tails doesn't allow downloading over PIP to /opt/tfc, so we first download
    # to $HOME, move the files to /opt/tfc, and then perform the hash verification

    # Install prerequisites before downloading other packages: This ensures pip accepts manylinux2014 wheels
    torsocks python3 -m pip download -r "${INSTALL_DIR}/requirements-pre.txt"   --require-hashes --no-deps --no-cache-dir -d "${HOME}/"
    verify_packages "${pre_packages[@]}"
    install_packages_as_root "${pre_packages[@]}"

    torsocks python3 -m pip download -r "${INSTALL_DIR}/requirements-venv.txt"        --require-hashes --no-deps --no-cache-dir -d "${HOME}/"
    torsocks python3 -m pip download -r "${INSTALL_DIR}/requirements-relay-tails.txt" --require-hashes --no-deps --no-cache-dir -d "${HOME}/"

    verify_packages "${virtualenv_packages[@]}"
    verify_packages "${tails_packages[@]}"

    install_packages_as_root "${virtualenv_packages[@]}"

    # Install Relay Program dependencies to virtualenv
    t_sudo python3 -m virtualenv ${INSTALL_DIR}/${VENV_NAME} --system-site-packages --always-copy
    . ${INSTALL_DIR}/${VENV_NAME}/bin/activate
    install_to_venv "${tails_packages[@]}"
    deactivate

    t_sudo mv ${INSTALL_DIR}/tfc.png                        /usr/share/pixmaps/
    t_sudo mv ${INSTALL_DIR}/launchers/TFC-RP-Tails.desktop /usr/share/applications/
    t_sudo mv ${INSTALL_DIR}/tfc.yml                        /etc/onion-grater.d/

    # Remove unnecessary files
    remove_packages "${pre_packages[@]}"
    remove_packages "${virtualenv_packages[@]}"
    remove_packages "${tails_packages[@]}"
    remove_common_files "t_sudo"
    t_sudo rm -r "${INSTALL_DIR}/src/receiver/"
    t_sudo rm -r "${INSTALL_DIR}/src/transmitter/"
    t_sudo rm -r "${INSTALL_DIR}/qubes/"
    t_sudo rm    "${INSTALL_DIR}/dd.py"
    t_sudo rm    "${INSTALL_DIR}/tfc.py"

    install_complete "Installation of the TFC Relay configuration is now complete."
}


# ----------------------------------------------------------------------------------------
# Installation configurations for Qubes OS (https://www.qubes-os.org/)

function install_qubes_src {
    # Qubes Source VM installation configuration for Debian 10 domains.
    create_user_data_dir

    steps_before_network_kill

    VENV_NAME="venv_tcb"

    verify_files

    install_packages_as_root "${virtualenv_packages[@]}"
    sudo python3 -m virtualenv "${INSTALL_DIR}/${VENV_NAME}" --system-site-packages --never-download --always-copy

    . ${INSTALL_DIR}/${VENV_NAME}/bin/activate
    install_to_venv "${tcb_packages[@]}"
    deactivate

    sudo mv ${INSTALL_DIR}/tfc.png                         /usr/share/pixmaps/
    sudo mv ${INSTALL_DIR}/launchers/TFC-TxP-Qubes.desktop /usr/share/applications/
    sudo mv ${INSTALL_DIR}/launchers/tfc-qubes-transmitter /usr/bin/tfc-transmitter

    # Remove unnecessary files
    remove_packages "${virtualenv_packages[@]}"
    remove_packages "${tcb_packages[@]}"
    remove_common_files "sudo"
    sudo rm -r "${INSTALL_DIR}/src/relay/"
    sudo rm -r "${INSTALL_DIR}/qubes/"  # Listening service only needed on NET/DST
    sudo rm    "${INSTALL_DIR}/dd.py"
    sudo rm    "${INSTALL_DIR}/relay.py"
    sudo rm    "${INSTALL_DIR}/tfc.yml"

    install_complete_qubes
}


function install_qubes_dst {
    # Qubes Destination VM installation configuration for Debian 10 domains.
    create_user_data_dir

    steps_before_network_kill

    VENV_NAME="venv_tcb"

    verify_files

    # Configure listening service for qrexec RPC
    sudo ln -sf /opt/tfc/qubes/service.sh /etc/qubes-rpc/tfc.NetworkerDestination
    sudo chmod a+x /opt/tfc/qubes/writer.py
    sudo chmod a+x /opt/tfc/qubes/service.sh

    install_packages_as_root "${virtualenv_packages[@]}"
    sudo python3 -m virtualenv "${INSTALL_DIR}/${VENV_NAME}" --system-site-packages --never-download --always-copy

    . ${INSTALL_DIR}/${VENV_NAME}/bin/activate
    install_to_venv "${tcb_packages[@]}"
    deactivate

    sudo mv ${INSTALL_DIR}/tfc.png                         /usr/share/pixmaps/
    sudo mv ${INSTALL_DIR}/launchers/TFC-RxP-Qubes.desktop /usr/share/applications/
    sudo mv ${INSTALL_DIR}/launchers/tfc-qubes-receiver    /usr/bin/tfc-receiver

    # Remove unnecessary files
    remove_packages "${virtualenv_packages[@]}"
    remove_packages "${tcb_packages[@]}"
    remove_common_files "sudo"
    sudo rm -r "${INSTALL_DIR}/src/relay/"
    sudo rm    "${INSTALL_DIR}/dd.py"
    sudo rm    "${INSTALL_DIR}/relay.py"
    sudo rm    "${INSTALL_DIR}/tfc.yml"

    install_complete_qubes
}


function install_qubes_net {
    # Qubes Networked VM installation configuration for Debian 10 domains.
    create_user_data_dir

    steps_before_network_kill

    VENV_NAME="venv_relay"

    verify_files

    # Configure listening service for qrexec RPC
    sudo ln -sf /opt/tfc/qubes/service.sh /etc/qubes-rpc/tfc.SourceNetworker
    sudo chmod a+x /opt/tfc/qubes/writer.py
    sudo chmod a+x /opt/tfc/qubes/service.sh

    install_packages_as_root "${virtualenv_packages[@]}"
    sudo python3 -m virtualenv ${INSTALL_DIR}/${VENV_NAME} --system-site-packages --always-copy

    . ${INSTALL_DIR}/${VENV_NAME}/bin/activate
    sudo torsocks ${INSTALL_DIR}/${VENV_NAME}/bin/pip3 install -r ${INSTALL_DIR}/requirements-relay.txt --require-hashes --no-deps
    deactivate

    sudo mv ${INSTALL_DIR}/tfc.png                        /usr/share/pixmaps/
    sudo mv ${INSTALL_DIR}/launchers/TFC-RP-Qubes.desktop /usr/share/applications/
    sudo mv ${INSTALL_DIR}/launchers/tfc-qubes-relay      /usr/bin/tfc-relay

    # Remove unnecessary files
    remove_packages "${virtualenv_packages[@]}"
    remove_packages "${tcb_packages[@]}"
    remove_common_files "sudo"
    sudo rm -r "${INSTALL_DIR}/src/receiver/"
    sudo rm -r "${INSTALL_DIR}/src/transmitter/"
    sudo rm    "${INSTALL_DIR}/dd.py"
    sudo rm    "${INSTALL_DIR}/tfc.py"
    sudo rm    "${INSTALL_DIR}/tfc.yml"

    install_complete_qubes
}


# ----------------------------------------------------------------------------------------
# Tiling terminal emulator configurations for single OS

function install_local_test {
    # Install TFC for local testing on a single computer.
    steps_before_network_kill

    verify_files
    create_user_data_dir

    VENV_NAME="venv_tfc"

    sudo torsocks apt install terminator -y

    install_virtualenv
    # Temporary fix for pypa/virtualenv issue #2350
    export DEB_PYTHON_INSTALL_LAYOUT='deb'
    sudo -E python3 -m virtualenv ${INSTALL_DIR}/${VENV_NAME} --system-site-packages --always-copy

    . ${INSTALL_DIR}/${VENV_NAME}/bin/activate
    sudo torsocks ${INSTALL_DIR}/${VENV_NAME}/bin/pip3 install -r ${INSTALL_DIR}/requirements.txt       --require-hashes --no-deps
    sudo torsocks ${INSTALL_DIR}/${VENV_NAME}/bin/pip3 install -r ${INSTALL_DIR}/requirements-relay.txt --require-hashes --no-deps
    deactivate

    sudo mv ${INSTALL_DIR}/tfc.png                                /usr/share/pixmaps/
    sudo mv ${INSTALL_DIR}/launchers/TFC-Local-test.desktop       /usr/share/applications/
    sudo mv ${INSTALL_DIR}/launchers/terminator-config-local-test ${INSTALL_DIR}/
    modify_terminator_font_size "sudo" "${INSTALL_DIR}/terminator-config-local-test"

    # Remove unnecessary files
    remove_packages "${virtualenv_packages[@]}"
    remove_packages "${tcb_packages[@]}"
    remove_common_files "sudo"
    sudo rm -r "${INSTALL_DIR}/qubes/"
    sudo rm    "${INSTALL_DIR}/tfc.yml"

    install_complete "Installation of TFC for local testing is now complete."
}


function install_developer {
    # Install TFC development configuration.
    #
    # This configuration will install TFC into `$HOME/tfc/`. This allows
    # you (the user) to easily make edits to the source between runs.
    # Note that it also means, that any malicious program with
    # user-level privileges is also able to modify the source files. For
    # more secure use on a single computer, select the local testing
    # install configuration, or preferably use the Qubes configuration.
    dpkg_check

    wait_for_tor
    create_user_data_dir

    VENV_NAME="venv_tfc"

    sudo torsocks apt update
    sudo torsocks apt install git libssl-dev python3-pip python3-tk terminator -y

    torsocks git clone https://github.com/maqp/tfc.git "${HOME}/tfc"
    cd "${HOME}/tfc"
    git checkout development

    torsocks python3 -m pip install -r "${HOME}/tfc/requirements-venv.txt" --require-hashes --no-deps

    # Temporary fix for pypa/virtualenv issue #2350
    export DEB_PYTHON_INSTALL_LAYOUT='deb'
    python3 -m virtualenv "${HOME}/tfc/${VENV_NAME}" --system-site-packages --always-copy

    . "${HOME}/tfc/${VENV_NAME}/bin/activate"
    torsocks "${HOME}/tfc/${VENV_NAME}/bin/pip3" install -r "${HOME}/tfc/requirements-dev.txt"
    deactivate

    sudo cp "${HOME}/tfc/tfc.png"                   "/usr/share/pixmaps/"
    sudo cp "${HOME}/tfc/launchers/TFC-Dev.desktop" "/usr/share/applications/"
    sudo sed -i "s|\$HOME|${HOME}|g"                "/usr/share/applications/TFC-Dev.desktop"
    modify_terminator_font_size "" "${HOME}/tfc/launchers/terminator-config-dev"
    chmod a+rwx -R "${HOME}/tfc/"

    # Remove unnecessary files
    sudo rm -f "/opt/install.sh"
    sudo rm -f "/opt/install.sh.asc"
    sudo rm -f "/opt/pubkey.asc"

    add_serial_permissions

    install_complete "Installation of the TFC dev environment is now complete."
}


function arg_error {
    # Print help message if the user launches the
    # installer with missing or invalid argument.
    clear
    echo -e "\nUsage: bash install.sh [OPTION]\n"
    echo    "Mandatory arguments"
    echo    "  tcb      Install Transmitter/Receiver Program (Debian 11 / PureOS 10.0 / *buntu 22.04 / LMDE 5 / Mint 21)"
    echo    "  relay    Install Relay Program                (Debian 11 / PureOS 10.0 / *buntu 22.04 / LMDE 5 / Mint 21 / Tails 5.4)"
    echo -e "  local    Install insecure local testing mode  (Debian 11 / PureOS 10.0 / *buntu 22.04 / LMDE 5 / Mint 21)\n"
    echo    "  qsrc     Install Transmitter Program          (Qubes 4.1.1)"
    echo    "  qdst     Install Receiver Program             (Qubes 4.1.1)"
    echo -e "  qnet     Install Relay Program                (Qubes 4.1.1)\n"
    exit 1
}


# ----------------------------------------------------------------------------------------
# Pre-install checks

function root_check {
    # Check that the installer was not launched as root.
    if [[ ! $EUID -ne 0 ]]; then
        exit_with_message "This installer must not be run as root."
    fi
}


function sudoer_check {
    # Check that the user who launched the installer is on the sudoers list.

    # Tails allows sudo without the user `amnesia` being on sudoers list.
    if ! lsb_release -a 2>/dev/null | grep -q Tails; then
        return
    fi

    sudoers=$(getent group sudo |cut -d: -f4 | tr "," "\n")
    user_is_sudoer=false

    for sudoer in ${sudoers}; do
        if [[ ${sudoer} == "${USER}" ]]; then
            user_is_sudoer=true
            break
        fi
    done

    if ! ${user_is_sudoer}; then
        exit_with_message "User ${USER} must be on the sudoers list."
    fi
}


function test_installer {
    # Test that the installer's hashes match the files.
    # Note: This function is only used as part of the release pipeline.
    INSTALL_DIR='.'
    verify_tcb_requirements_files
    verify_files
}

function wait_for_tor {
    # Wait until Torsocks connects properly to GitHub
    c_echo "Waiting for Tor..."
    until torsocks wget -T 10 -q https://raw.githubusercontent.com; do
        sleep 1
    done
}


# ----------------------------------------------------------------------------------------
# Main routine

set -e
root_check
sudoer_check
sudo_pwd=''

case $1 in
    tcb    ) install_tcb;;
    relay  ) install_relay;;
    tails  ) install_relay_tails;;
    local  ) install_local_test;;
    qsrc   ) install_qubes_src;;
    qdst   ) install_qubes_dst;;
    qnet   ) install_qubes_net;;
    dev    ) install_developer;;
    test   ) test_installer;;
    *      ) arg_error;;
esac
